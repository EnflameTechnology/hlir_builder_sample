


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TopsGraph Compiler &mdash; HLIR Builder master documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/docs/stable/tops_graph_compiler.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/cpp_theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/collapsible-lists/css/tree_view.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="C++ API" href="api/library_root.html" />
    <link rel="prev" title="Client Operation Semantics" href="client_operation_semantics.html" />
  <!-- Google Analytics -->
  
  <!-- End Google Analytics -->
  

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <!--a class="header-logo" href="https://www.enflame-tech.com" aria-label="Builder"></a> -->
      <a class="header-logo" aria-label="Builder"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a class="reference internal" href="get_started.html">Get Started</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Operation Semantics
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="meta_operation_semantics.html">
                  <span class="dropdown-title">Meta Ops</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="client_operation_semantics.html">
                  <span class="dropdown-title">Client Ops</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <a class="reference internal" href="api/library_root.html">C++ API</a>
          </li>

          <li>
            <!--<a href="https://www.enflame-tech.com">Python API</a> -->
            <a>Python API</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Tutorials
              </a>
              <div class="resources-dropdown-menu">
                <!--<a class="doc-dropdown-option nav-dropdown-item" href="https://www.enflame-tech.com"> -->
                <a class="doc-dropdown-option nav-dropdown-item">
                  <span class="dropdown-title">Inference</span>
                  <p></p>
                </a>
                <!--<a class="doc-dropdown-option nav-dropdown-item" href="https://www.enflame-tech.com"> -->
                <a class="doc-dropdown-option nav-dropdown-item">
                  <span class="dropdown-title">Trainning</span>
                  <p></p>
                </a>
            </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta_operation_semantics.html">Meta Operation Semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_operation_semantics.html">Client Operation Semantics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TopsGraph Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/library_root.html">C++ API</a></li>
</ul>
<p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notes/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/version.html">Version</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>TopsGraph Compiler</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/tops_graph_compiler.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="topsgraph-compiler">
<h1>TopsGraph Compiler<a class="headerlink" href="#topsgraph-compiler" title="Permalink to this headline">¶</a></h1>
<p>TopsGraph Compiler is the middle node of the whole pipeline:</p>
<p>Build(<code class="docutils literal notranslate"><span class="pre">HLIR</span> <span class="pre">Builder</span></code>) –&gt; Compile(<code class="docutils literal notranslate"><span class="pre">TopsGraph</span> <span class="pre">Compiler</span></code>) –&gt; Run(<code class="docutils literal notranslate"><span class="pre">Tops</span> <span class="pre">Runtime</span></code>).</p>
<p>So its interfaces can roughly be divided into three parts:</p>
<ul class="simple">
<li><p><strong>Read Built IR</strong>: Read the IR(Intermediate Representation) built by HLIR Builder.</p></li>
<li><p><strong>Compile Graph</strong>: Compile the graph with multi-level optimization strategies.</p></li>
<li><p><strong>Produce Binary</strong>: Produces a binary which can be read by runtime apis and then run on GCU devices.</p></li>
</ul>
<p>More details please refer to <code class="docutils literal notranslate"><span class="pre">C++</span> <span class="pre">API</span></code>, <code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Started</span></code> and “Pass Built IR to TopsGraph Compiler” in <code class="docutils literal notranslate"><span class="pre">Example</span></code>.</p>
<div class="section" id="read-built-ir">
<h2>Read Built IR<a class="headerlink" href="#read-built-ir" title="Permalink to this headline">¶</a></h2>
<p>There are two ways to read the built IR. The string format of ir is easy to read for users, while the data struct of <code class="docutils literal notranslate"><span class="pre">hlir::Module</span></code> is easy to parse by programming.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// receive pointer to ir string, which can be obtained by Builder::GetModuleStr</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphCreateProgramFromString</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="o">*</span><span class="w"> </span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="k">module</span><span class="p">);</span><span class="w"></span>
<span class="c1">// receive pointer to hlir::Module, which can be obtained by Builder::GetModule</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphCreateProgramFromModule</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="o">*</span><span class="w"> </span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="n">hlir</span><span class="o">::</span><span class="n">Module</span><span class="o">*</span><span class="w"> </span><span class="k">module</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When the binary was obtained, do not forget to destroy the program created here by calling the following interface:</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// destroy the created program to free resources</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphDestroyProgram</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="o">*</span><span class="w"> </span><span class="n">program</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="compile-graph">
<h2>Compile Graph<a class="headerlink" href="#compile-graph" title="Permalink to this headline">¶</a></h2>
<p>This is the main part of TopsGraph Compiler. Users can set the compile options, which contains the target device and the optimizing pipeline. A sample code if as following:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// compile with compile options</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphCompileProgram</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="w"> </span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numOptions</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">options</span><span class="p">);</span><span class="w"></span>

<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">options</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;-arch=gcu210&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;-resource=1c4s&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;-hlir=tops-hlir-pipeline{shape-inference=true dynamic-shape=true}&quot;</span><span class="p">};</span><span class="w"></span>
<span class="c1">// there are 3 options, so set numOptions as 3</span>
<span class="k">auto</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topsgraphCompileProgram</span><span class="p">(</span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>For the target resource below, <code class="docutils literal notranslate"><span class="pre">c</span></code> is short for cluster and <code class="docutils literal notranslate"><span class="pre">s</span></code> is short for sip.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Arch</p></th>
<th class="head"><p>Resource</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>gcu200</p></td>
<td><p>1c6s</p></td>
</tr>
<tr class="row-odd"><td><p>gcu200</p></td>
<td><p>4c24s</p></td>
</tr>
<tr class="row-even"><td><p>gcu210</p></td>
<td><p>1c4s</p></td>
</tr>
<tr class="row-odd"><td><p>gcu210</p></td>
<td><p>1c12s</p></td>
</tr>
<tr class="row-even"><td><p>gcu210</p></td>
<td><p>2c24s</p></td>
</tr>
</tbody>
</table>
<p>For the optimizing pipelines, we only take hlir in account. The demo in <code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Started</span></code> uses “hlir-pipeline{}” for graph with static shapes.
The upper sample code uses “tops-hlir-pipeline{shape-inference=true dynamic-shape=true}” for graph with dynamic shape. You can refer to the example of “Build Graph with Dynamic Shape” in <code class="docutils literal notranslate"><span class="pre">Examples</span></code> to learn how to build a graph with dynamic shape.
Please concat to us to get more informaton of compile options.</p>
</div>
<div class="section" id="produce-binary">
<h2>Produce Binary<a class="headerlink" href="#produce-binary" title="Permalink to this headline">¶</a></h2>
<p>If compiled successfully, users can obtain the binary via the following interfaces:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// get the binary size</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphGetBinSize</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="w"> </span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">binary_size</span><span class="p">);</span><span class="w"></span>
<span class="c1">// get the binary pointer</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphGetBin</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="w"> </span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">binary</span><span class="p">);</span><span class="w"></span>
<span class="c1">// save the binary to a file</span>
<span class="n">topsgraphResult</span><span class="w"> </span><span class="nf">topsgraphSaveBinFile</span><span class="p">(</span><span class="n">topsgraphProgram</span><span class="w"> </span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">save_file</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For debug mode, users can set environment variables as following to dump all the irs of the compile pipelines to log files in the specified directory.</p>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">COMPILE_OPTIONS_MLIR_DBG</span><span class="o">=</span><span class="s2">&quot;-pass-timing -pass-statistics -mlir-elide-elementsattrs-if-larger=100 --print-ir-before-all=true --print-ir-after-all=true -log-output-path=/tmp/irdump/&quot;</span>
</pre></div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/library_root.html" class="btn btn-neutral float-right" title="C++ API" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="client_operation_semantics.html" class="btn btn-neutral" title="Client Operation Semantics" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, HLIR Builder Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">TopsGraph Compiler</a><ul>
<li><a class="reference internal" href="#read-built-ir">Read Built IR</a></li>
<li><a class="reference internal" href="#compile-graph">Compile Graph</a></li>
<li><a class="reference internal" href="#produce-binary">Produce Binary</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
         <script src="_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for HLIR Builder</p>
          <!--<a class="with-right-arrow" href="https://www.enflame-tech.com">View Docs</a> -->
          <a class="with-right-arrow">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <!--<a class="with-right-arrow" href="https://www.enflame-tech.com">View Tutorials</a> -->
          <a class="with-right-arrow">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <!--<a class="with-right-arrow" href="https://www.enflame-tech.com">View Resources</a> -->
          <a class="with-right-arrow">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <!--<div class="footer-logo-wrapper">
        <a href="https://www.enflame-tech.com" class="footer-logo"></a>
      </div>-->

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <!--<li><a href="https://www.enflame-tech.com">Get Started</a></li> -->
            <li><a>Get Started</a></li>
            <!--<li><a href="https://www.enflame-tech.com">Features</a></li> -->
            <li><a>C++ API</a></li>
            <!--<li><a href="https://www.enflame-tech.com">Ecosystem</a></li> -->
            <li><a>Python API</a></li>
            <!--<li><a href="https://www.enflame-tech.com">Blog</a></li> -->
            <li><a>Tutorials</a></li>
            <!--<li><a href="https://www.enflame-tech.com">Contributing</a></li> -->
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <!--<li class="list-title"><a href="https://www.enflame-tech.com">Resources</a></li> -->
            <li class="list-title"><a>Contributing</a></li>
            <!--<li><a href="https://www.enflame-tech.com">Tutorials</a></li> -->
            <!--<li><a href="https://www.enflame-tech.com">Docs</a></li> -->
            <li><a>Applications</a></li>
            <!--<li><a href="https://www.enflame-tech.com" target="_blank">Discuss</a></li> -->
            <li><a>Discuss</a></li>
            <!--<li><a href="https://www.enflame-tech.com" target="_blank">Github Issues</a></li> -->
            <li><a>Github Issues</a></li>
            <!--<li><a href="https://www.enflame-tech.com" target="_blank">Brand Guidelines</a></li> -->
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>